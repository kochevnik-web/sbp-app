import React, {useState, useContext} from 'react';
import {motion, AnimatePresence } from 'framer-motion';

import './ChipError.scss';
import { Context } from "../../context";

export default function ChipError({x, y}) {

    const { hendleAddCounter } = useContext(Context);

    function getLeft(){
        const min = window.innerWidth <= 768 ? 2 : 23;
        const max = window.innerWidth <= 768 ? 51 : 75;

        return Math.floor(Math.random() * (max - min + 1)) + min;
    }

    function getTop(){
        const min = window.innerWidth <= 768 ? 10 : 15;
        const max = window.innerWidth <= 768 ? 60 : 40;

        return Math.floor(Math.random() * (max - min + 1)) + min;
    }

    const [fly, setFly] = useState(false);
    const [randLeft, setRandLeft] = useState(getLeft());
    const [randTop, setRandRight] = useState(getTop());
    const [randSVG, setRandSVG] = useState(Math.floor(Math.random() * (4 - 1 + 1)) + 1);

    let clx = ['chip-wrap'];
    if(fly){
        clx.push('fly');
    }

    const hendleCounter = () => {
        setFly(true);
        hendleAddCounter();
    }

    let variants = {
        start: {opacity: 0.3, transition: {delay: 7.5, duration: 0.5}, transitionEnd: {display: 'none'}},
        finish: {opacity: 1},
    }

    return (
        <AnimatePresence>
            <motion.div
                className="ChipError"
                animate={{opacity: 1, scale: 1, y: 0}}
                transition={{duration: 0.5, delay: 0.3, type:"spring"}}
                initial={{opacity: 0, scale: 0.5, y: '20em'}}
                exit={{opacity: 0}}
                style={{left: randLeft + '%', bottom: randTop + '%'}}
            >
                <motion.div
                    className={fly ? "chip-wrap-hide fly2" : "chip-wrap-hide"}
                    variants={variants}
                    animate="start"
                    initial="finish"
                    exit="finish"
                    onClick={hendleCounter}
                >
                    <div className={clx.join(' ')}>
                        <div className="chip-animate">
                            {randSVG === 1 && (
                            <svg viewBox="0 0 72 72" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M36 72C55.8823 72 72 55.8823 72 36C72 16.1177 55.8823 0 36 0C16.1177 0 0 16.1177 0 36C0 55.8823 16.1177 72 36 72Z" fill="#FFF2DA"/>
                                <path d="M10.8309 39.5571L47.7249 58.5541C49.7099 59.576 52.2199 58.6561 53.3309 56.4991L62.7529 38.2001C63.8639 36.0431 63.1549 33.4651 61.1699 32.4431L24.2749 13.4461C22.2899 12.4241 19.7799 13.3441 18.6689 15.5011L9.24693 33.8001C8.13593 35.9571 8.84493 38.5351 10.8309 39.5571Z" fill="#72B22C"/>
                                <path d="M56.402 50.5382L12.3169 27.8386L9.45839 33.3902L53.5435 56.0897L56.402 50.5382Z" fill="#5E5A94"/>
                                <path d="M33.2656 21.0709L23.5503 16.0586L20.7699 21.4477L30.4852 26.46L33.2656 21.0709Z" fill="#FBBB20"/>
                            </svg>)}

                            {randSVG === 2 && (
                            <svg viewBox="0 0 72 72" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M36 72C55.8823 72 72 55.8823 72 36C72 16.1177 55.8823 0 36 0C16.1177 0 0 16.1177 0 36C0 55.8823 16.1177 72 36 72Z" fill="#FFF2DA"/>
                                <path d="M19.2 22.5329L27.202 25.1719C27.202 25.1719 39.89 21.0599 41.14 18.4749C42.389 15.8889 42.742 9.61392 44.547 9.44292C46.352 9.27192 49.842 9.85892 50.673 14.1529C51.276 17.2699 46.711 26.2799 47.424 27.2389C47.87 27.8389 52.426 29.4879 55.774 30.6379C57.976 31.3939 59.564 33.3319 59.902 35.6689L59.903 35.6759C60.132 37.2559 59.237 38.7949 57.758 39.3659L55.456 40.2549L56.191 42.6319C56.738 44.4019 55.768 46.3039 54.021 46.8899L52.24 47.4869L52.809 48.9349C53.542 50.7999 52.509 52.9159 50.593 53.4729L49.037 53.9249L49.101 54.3409C49.368 56.0719 48.284 57.7369 46.605 58.1769L45.06 58.5819L23.747 51.5479C21.75 50.8889 19.912 49.8209 18.345 48.4109L11.267 44.6749C10.506 44.2729 10.156 43.3639 10.443 42.5379L17.005 23.6419C17.321 22.7299 18.299 22.2359 19.2 22.5329Z" fill="#FBBB20"/>
                            </svg>)}

                            {randSVG === 3 && (
                            <svg viewBox="0 0 72 72" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M36 72C55.8823 72 72 55.8823 72 36C72 16.1177 55.8823 0 36 0C16.1177 0 0 16.1177 0 36C0 55.8823 16.1177 72 36 72Z" fill="#FFF2DA"/>
                                <path d="M35.6799 43.173C45.1256 43.173 52.7829 35.5158 52.7829 26.07C52.7829 16.6243 45.1256 8.96704 35.6799 8.96704C26.2342 8.96704 18.5769 16.6243 18.5769 26.07C18.5769 35.5158 26.2342 43.173 35.6799 43.173Z" fill="#FBBB20"/>
                                <path d="M22.594 37.0789C25.731 40.8039 30.428 43.1739 35.68 43.1739C45.126 43.1739 52.784 35.5169 52.784 26.0699C52.784 24.0849 52.442 22.1809 51.821 20.4089C42.175 26.1339 32.441 31.7069 22.594 37.0789Z" fill="#FED072"/>
                                <path d="M35.409 38.8011C42.5898 38.8011 48.411 32.9799 48.411 25.7991C48.411 18.6183 42.5898 12.7971 35.409 12.7971C28.2282 12.7971 22.407 18.6183 22.407 25.7991C22.407 32.9799 28.2282 38.8011 35.409 38.8011Z" fill="#FBBB20"/>
                                <path d="M35.4078 39.1269C28.0588 39.1269 22.0808 33.1479 22.0808 25.7989C22.0808 18.4499 28.0598 12.4709 35.4078 12.4709C42.7578 12.4709 48.7358 18.4499 48.7358 25.7989C48.7358 33.1479 42.7578 39.1269 35.4078 39.1269ZM35.4078 13.4709C28.6108 13.4709 23.0808 19.0009 23.0808 25.7989C23.0808 32.5969 28.6108 38.1269 35.4078 38.1269C42.2058 38.1269 47.7358 32.5969 47.7358 25.7989C47.7358 19.0009 42.2058 13.4709 35.4078 13.4709Z" fill="#FFF2DA"/>
                                <path d="M23.5549 56.2299C33.0006 56.2299 40.6579 48.5727 40.6579 39.1269C40.6579 29.6812 33.0006 22.0239 23.5549 22.0239C14.1092 22.0239 6.4519 29.6812 6.4519 39.1269C6.4519 48.5727 14.1092 56.2299 23.5549 56.2299Z" fill="#FBBB20"/>
                                <path d="M10.469 50.1348C13.606 53.8598 18.303 56.2298 23.555 56.2298C33.001 56.2298 40.659 48.5728 40.659 39.1258C40.659 37.1408 40.317 35.2368 39.696 33.4648C30.05 39.1908 20.316 44.7638 10.469 50.1348Z" fill="#FED072"/>
                                <path d="M23.284 51.858C30.4648 51.858 36.286 46.0368 36.286 38.856C36.286 31.6752 30.4648 25.854 23.284 25.854C16.1032 25.854 10.282 31.6752 10.282 38.856C10.282 46.0368 16.1032 51.858 23.284 51.858Z" fill="#FBBB20"/>
                                <path d="M23.2828 52.1829C15.9338 52.1829 9.95581 46.2039 9.95581 38.8549C9.95581 31.5059 15.9348 25.5269 23.2828 25.5269C30.6328 25.5269 36.6108 31.5059 36.6108 38.8549C36.6108 46.2039 30.6328 52.1829 23.2828 52.1829ZM23.2828 26.5279C16.4858 26.5279 10.9558 32.0579 10.9558 38.8559C10.9558 45.6539 16.4858 51.1839 23.2828 51.1839C30.0808 51.1839 35.6108 45.6539 35.6108 38.8559C35.6108 32.0579 30.0808 26.5279 23.2828 26.5279Z" fill="#FFF2DA"/>
                                <path d="M47.8049 56.2299C57.2506 56.2299 64.9079 48.5727 64.9079 39.1269C64.9079 29.6812 57.2506 22.0239 47.8049 22.0239C38.3592 22.0239 30.7019 29.6812 30.7019 39.1269C30.7019 48.5727 38.3592 56.2299 47.8049 56.2299Z" fill="#FBBB20"/>
                                <path d="M34.719 50.1348C37.856 53.8598 42.553 56.2298 47.805 56.2298C57.251 56.2298 64.909 48.5728 64.909 39.1258C64.909 37.1408 64.567 35.2368 63.946 33.4648C54.3 39.1908 44.566 44.7638 34.719 50.1348Z" fill="#FED072"/>
                                <path d="M47.534 51.858C54.7148 51.858 60.536 46.0368 60.536 38.856C60.536 31.6752 54.7148 25.854 47.534 25.854C40.3532 25.854 34.532 31.6752 34.532 38.856C34.532 46.0368 40.3532 51.858 47.534 51.858Z" fill="#FBBB20"/>
                                <path d="M47.5328 52.1829C40.1838 52.1829 34.2058 46.2039 34.2058 38.8549C34.2058 31.5059 40.1848 25.5269 47.5328 25.5269C54.8828 25.5269 60.8608 31.5059 60.8608 38.8549C60.8608 46.2039 54.8828 52.1829 47.5328 52.1829ZM47.5328 26.5279C40.7358 26.5279 35.2058 32.0579 35.2058 38.8559C35.2058 45.6539 40.7358 51.1839 47.5328 51.1839C54.3308 51.1839 59.8608 45.6539 59.8608 38.8559C59.8608 32.0579 54.3308 26.5279 47.5328 26.5279Z" fill="#FFF2DA"/>
                            </svg>
                            )}

                            {randSVG === 4 && (
                            <svg viewBox="0 0 72 72" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M36 72C55.8823 72 72 55.8823 72 36C72 16.1177 55.8823 0 36 0C16.1177 0 0 16.1177 0 36C0 55.8823 16.1177 72 36 72Z" fill="#FFF2DA"/>
                                <path d="M15.4151 44.7341C12.5151 46.2861 11.8331 45.5601 10.4851 44.4641C9.41407 43.5941 9.25707 41.7931 9.94307 40.3161C10.4791 39.1641 11.2001 38.8161 12.9031 38.9821C12.8701 38.3731 12.8661 37.7811 12.8031 37.1941C12.4441 33.8191 12.4491 30.4631 13.1671 27.1251C14.0501 23.0191 16.1621 19.7011 19.4421 17.0911C22.9281 14.3161 26.9291 12.7701 31.2801 12.0591C34.6631 11.5061 38.0571 11.2791 41.4851 11.7071C47.8021 12.4961 54.3431 16.7071 56.1291 24.3581C57.0621 28.3531 57.5661 32.3721 57.0791 36.4751C56.7931 38.8911 57.1711 41.2811 57.3811 43.6801C57.5791 45.9371 57.4171 48.1481 56.2061 50.1571C55.9581 50.5691 55.7221 50.9981 55.4101 51.3591C52.5781 54.6401 49.1631 57.0961 45.0581 58.5401C40.8411 60.0241 36.5231 60.8061 32.0291 60.4151C27.6071 60.0301 23.5481 58.6281 19.9581 56.0241C17.8081 54.4651 16.6921 52.1551 16.0571 49.6451C15.7381 48.3841 15.6701 47.0581 15.4971 45.7611C15.4551 45.4341 15.4441 45.1011 15.4151 44.7341ZM49.8511 21.0901C49.6361 20.9471 49.4311 20.8651 49.3091 20.7151C49.1661 20.5391 49.0941 20.3041 48.9921 20.0951C49.2611 20.0301 49.5601 19.8551 49.7921 19.9191C50.6741 20.1651 51.0561 21.1311 50.5531 21.9161C49.9181 22.9071 48.9511 23.3951 47.7721 23.3401C46.6311 23.2871 45.9331 22.5731 45.5591 21.5661C45.2581 20.7571 45.3671 19.9271 45.7351 19.1441C45.8651 18.8681 46.0621 18.6191 46.1621 18.3341C46.3961 17.6641 46.0181 17.2011 45.3111 17.2711C44.5671 17.3451 44.1681 17.8561 43.8741 18.4691C42.8881 20.5281 43.7641 23.1111 45.7581 24.0851C48.2391 25.2971 50.6461 23.7421 51.4771 22.1151C51.9591 21.1721 51.7531 19.9071 51.0131 19.2021C50.4971 18.7101 49.8771 18.5341 49.1991 18.7581C48.5731 18.9651 48.1151 19.4121 48.1081 20.0871C48.1041 20.4791 48.2381 20.9881 48.5041 21.2381C48.8531 21.5691 49.3781 21.5611 49.8511 21.0901ZM41.8181 48.5461C42.5731 48.7801 43.3041 49.0731 44.0641 49.2271C45.1651 49.4491 46.2571 49.3281 47.2211 48.7011C47.7401 48.3641 48.1481 47.9141 47.7221 47.0571C47.3291 47.2661 46.9961 47.4321 46.6731 47.6171C45.4041 48.3431 43.3901 48.1301 42.4211 47.0691C42.1311 46.7521 42.0711 46.2201 41.9221 45.7801C41.7981 45.4121 41.7481 44.9151 41.2441 44.9601C40.6831 45.0101 40.8181 45.5051 40.8411 45.8851C40.8461 45.9721 40.8601 46.0591 40.8771 46.1451C41.0781 47.1761 40.9771 48.1411 40.3401 49.0251C40.1971 49.2231 40.1931 49.5211 40.1251 49.7731C40.2081 49.8241 40.2901 49.8761 40.3731 49.9271C40.8581 49.4651 41.3411 49.0031 41.8181 48.5461ZM13.0981 41.2401C12.0521 40.7291 11.4281 40.8631 11.0631 41.6031C10.6061 42.5311 11.0411 43.6291 12.0001 43.9721C12.8351 44.2711 13.3711 44.0341 13.6641 43.1901C13.2751 43.1231 12.8811 43.1011 12.5181 42.9841C11.8581 42.7721 11.7601 42.1201 12.3141 41.6881C12.5331 41.5181 12.7981 41.4091 13.0981 41.2401Z" fill="#FFDD9E"/>
                                <path d="M49.851 21.0901C49.377 21.5611 48.853 21.5691 48.504 21.2401C48.238 20.9901 48.104 20.4811 48.108 20.0891C48.115 19.4131 48.574 18.9661 49.199 18.7601C49.877 18.5361 50.497 18.7121 51.013 19.2041C51.752 19.9091 51.958 21.1741 51.477 22.1171C50.647 23.7441 48.239 25.2981 45.758 24.0871C43.763 23.1131 42.887 20.5301 43.874 18.4711C44.168 17.8571 44.567 17.3461 45.311 17.2731C46.018 17.2031 46.396 17.6661 46.162 18.3361C46.063 18.6211 45.865 18.8701 45.735 19.1461C45.367 19.9291 45.258 20.7591 45.559 21.5681C45.933 22.5751 46.631 23.2881 47.772 23.3421C48.951 23.3971 49.918 22.9091 50.553 21.9181C51.056 21.1331 50.674 20.1671 49.792 19.9211C49.56 19.8561 49.26 20.0321 48.992 20.0971C49.095 20.3061 49.166 20.5411 49.309 20.7171C49.431 20.8661 49.637 20.9481 49.851 21.0901Z" fill="#1A0940"/>
                                <path d="M41.818 48.5461C41.341 49.0031 40.857 49.4651 40.374 49.9271C40.291 49.8761 40.209 49.8241 40.126 49.7731C40.194 49.5211 40.198 49.2231 40.341 49.0251C40.978 48.1411 41.079 47.1761 40.878 46.1451C40.861 46.0591 40.847 45.9721 40.842 45.8851C40.819 45.5041 40.684 45.0091 41.245 44.9601C41.748 44.9151 41.798 45.4121 41.923 45.7801C42.072 46.2191 42.132 46.7511 42.422 47.0691C43.391 48.1301 45.405 48.3431 46.674 47.6171C46.997 47.4321 47.33 47.2661 47.723 47.0571C48.149 47.9141 47.741 48.3631 47.222 48.7011C46.258 49.3281 45.166 49.4491 44.065 49.2271C43.305 49.0731 42.573 48.7801 41.818 48.5461Z" fill="#1A0940"/>
                                <path d="M35.1011 42.1861C34.1801 42.1021 34.2601 43.1301 33.8481 43.6081C33.5851 43.9131 33.2731 44.2801 32.8831 43.9531C32.6831 43.7851 32.5851 43.3121 32.6581 43.0331C32.9251 42.0181 33.5501 41.2371 34.5261 40.8131C35.4711 40.4021 36.4731 40.8501 37.1061 41.5911C37.5641 42.1261 38.3731 43.6161 37.4421 44.0591C36.9121 44.3111 36.5251 44.0391 36.2481 43.5791C35.9841 43.1421 35.9581 42.2641 35.1011 42.1861Z" fill="#1A0940"/>
                                <path d="M49.937 42.9791C49.608 42.8161 49.458 42.2121 49.505 41.7251C49.587 40.8661 50.104 40.0811 50.899 39.7251C51.998 39.2321 53.219 39.7281 53.718 40.8881C53.819 41.1231 53.928 41.4071 53.884 41.6401C53.833 41.9091 53.653 42.3121 53.46 42.3561C53.002 42.4611 52.401 42.1631 52.297 41.7311C52.191 41.2911 51.756 40.8911 51.319 41.0071C50.696 41.1731 50.656 41.6791 50.593 42.1911C50.55 42.5471 50.465 43.2401 49.937 42.9791Z" fill="#1A0940"/>
                                <path d="M13.0982 41.2402C12.7982 41.4092 12.5332 41.5182 12.3152 41.6882C11.7612 42.1202 11.8592 42.7722 12.5192 42.9842C12.8822 43.1012 13.2752 43.1232 13.6652 43.1902C13.3722 44.0342 12.8362 44.2702 12.0012 43.9722C11.0422 43.6292 10.6072 42.5312 11.0642 41.6032C11.4272 40.8632 12.0522 40.7292 13.0982 41.2402Z" fill="#1A0940"/>
                                <path d="M45.8381 44.958C46.0151 44.688 46.4451 44.687 46.5351 44.322C46.6001 44.057 46.4751 43.768 46.2631 43.597C45.9711 43.362 44.5451 43.471 45.5611 42.945C46.0341 42.7 46.5761 42.737 46.9851 43.091C47.4511 43.494 47.4331 44.008 47.1651 44.517C46.9511 44.924 46.2041 45.384 45.7861 45.069C45.7991 45.027 45.8171 44.991 45.8381 44.958Z" fill="#1A0940"/>
                                <path d="M35.4462 50.5262C37.0544 50.5262 38.3582 49.4414 38.3582 48.1032C38.3582 46.765 37.0544 45.6802 35.4462 45.6802C33.8379 45.6802 32.5342 46.765 32.5342 48.1032C32.5342 49.4414 33.8379 50.5262 35.4462 50.5262Z" fill="#F9BD92"/>
                                <path d="M53.1979 48.8057C54.7519 48.4882 55.7944 47.1679 55.5265 45.8569C55.2586 44.5459 53.7817 43.7405 52.2278 44.0581C50.6738 44.3756 49.6312 45.6958 49.8991 47.0069C50.1671 48.3179 51.644 49.1233 53.1979 48.8057Z" fill="#F9BD92"/>
                            </svg>
                            )}
                        </div>
                    </div>
                </motion.div>
            </motion.div>
        </AnimatePresence>
    )
}