import React, {useState, useContext} from 'react';
import {motion, AnimatePresence } from 'framer-motion';

import './ChipError.scss';
import { Context } from "../../context";

export default function ChipError({x, y}) {

    const { hendleAddCounter, getLeft, getTop } = useContext(Context);

    const [fly, setFly] = useState(false);
    const [randLeft, setRandLeft] = useState(getLeft());
    const [randTop, setRandRight] = useState(getTop());
    const [randSVG, setRandSVG] = useState(Math.floor(Math.random() * (4 - 1 + 1)) + 1);

    let clx = ['chip-wrap'];
    if(fly){
        clx.push('fly');
    }

    const hendleCounter = () => {
        setFly(true);
        hendleAddCounter();
    }

    let variants = {
        start: {opacity: 0.3, transition: {delay: 7.5, duration: 0.5}, transitionEnd: {display: 'none'}},
        finish: {opacity: 1},
    }

    return (
        <AnimatePresence>
            <motion.div
                className="ChipError"
                animate={{opacity: 1, scale: 1, y: 0}}
                transition={{duration: 0.5, delay: 0.3, type:"spring"}}
                initial={{opacity: 0, scale: 0.5, y: '20em'}}
                exit={{opacity: 0}}
                style={{left: randLeft + '%', bottom: randTop + '%'}}
            >
                <motion.div
                    className={fly ? "chip-wrap-hide fly2" : "chip-wrap-hide"}
                    variants={variants}
                    animate="finish"
                    initial="finish"
                    exit="finish"
                    onClick={hendleCounter}
                >
                    <div className={clx.join(' ')}>
                        <div className="chip-animate">
                            {randSVG === 1 && (
                            <svg viewBox="0 0 76 76" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M38 74C57.8823 74 74 57.8823 74 38C74 18.1177 57.8823 2 38 2C18.1177 2 2 18.1177 2 38C2 57.8823 18.1177 74 38 74Z" fill="#FFF2DA" stroke="#1A0940" strokeWidth="3"/>
                                <path d="M12.8309 41.5571L49.7249 60.5541C51.7099 61.576 54.2199 60.6561 55.3309 58.4991L64.7529 40.2001C65.8639 38.0431 65.1549 35.4651 63.1699 34.4431L26.2749 15.4461C24.2899 14.4241 21.7799 15.3441 20.6689 17.5011L11.2469 35.8001C10.1359 37.9571 10.8449 40.5351 12.8309 41.5571Z" fill="#72B22C"/>
                                <path d="M58.402 52.5382L14.3169 29.8386L11.4584 35.3902L55.5435 58.0897L58.402 52.5382Z" fill="#5E5A94"/>
                                <path d="M35.2656 23.0709L25.5503 18.0586L22.7699 23.4477L32.4852 28.46L35.2656 23.0709Z" fill="#FBBB20"/>
                            </svg>)}

                            {randSVG === 2 && (
                            <svg viewBox="0 0 76 76" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M38 74C57.8823 74 74 57.8823 74 38C74 18.1177 57.8823 2 38 2C18.1177 2 2 18.1177 2 38C2 57.8823 18.1177 74 38 74Z" fill="#FFF2DA" stroke="#1A0940" strokeWidth="3"/>
                                <path d="M21.2 24.5329L29.202 27.1719C29.202 27.1719 41.89 23.0599 43.14 20.4749C44.389 17.8889 44.742 11.6139 46.547 11.4429C48.352 11.2719 51.842 11.8589 52.673 16.1529C53.276 19.2699 48.711 28.2799 49.424 29.2389C49.87 29.8389 54.426 31.4879 57.774 32.6379C59.976 33.3939 61.564 35.3319 61.902 37.6689L61.903 37.6759C62.132 39.2559 61.237 40.7949 59.758 41.3659L57.456 42.2549L58.191 44.6319C58.738 46.4019 57.768 48.3039 56.021 48.8899L54.24 49.4869L54.809 50.9349C55.542 52.7999 54.509 54.9159 52.593 55.4729L51.037 55.9249L51.101 56.3409C51.368 58.0719 50.284 59.7369 48.605 60.1769L47.06 60.5819L25.747 53.5479C23.75 52.8889 21.912 51.8209 20.345 50.4109L13.267 46.6749C12.506 46.2729 12.156 45.3639 12.443 44.5379L19.005 25.6419C19.321 24.7299 20.299 24.2359 21.2 24.5329Z" fill="#FBBB20"/>
                            </svg>)}

                            {randSVG === 3 && (
                            <svg viewBox="0 0 76 76" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M38 74C57.8823 74 74 57.8823 74 38C74 18.1177 57.8823 2 38 2C18.1177 2 2 18.1177 2 38C2 57.8823 18.1177 74 38 74Z" fill="#FFF2DA" stroke="#1A0940" strokeWidth="3"/>
                                <path d="M17.4151 46.7341C14.5151 48.2861 13.8331 47.5601 12.4851 46.4641C11.4141 45.5941 11.2571 43.7931 11.9431 42.3161C12.4791 41.1641 13.2001 40.8161 14.9031 40.9821C14.8701 40.3731 14.8661 39.7811 14.8031 39.1941C14.4441 35.8191 14.4491 32.4631 15.1671 29.1251C16.0501 25.0191 18.1621 21.7011 21.4421 19.0911C24.9281 16.3161 28.9291 14.7701 33.2801 14.0591C36.6631 13.5061 40.0571 13.2791 43.4851 13.7071C49.8021 14.4961 56.3431 18.7071 58.1291 26.3581C59.0621 30.3531 59.5661 34.3721 59.0791 38.4751C58.7931 40.8911 59.1711 43.2811 59.3811 45.6801C59.5791 47.9371 59.4171 50.1481 58.2061 52.1571C57.9581 52.5691 57.7221 52.9981 57.4101 53.3591C54.5781 56.6401 51.1631 59.0961 47.0581 60.5401C42.8411 62.0241 38.5231 62.8061 34.0291 62.4151C29.6071 62.0301 25.5481 60.6281 21.9581 58.0241C19.8081 56.4651 18.6921 54.1551 18.0571 51.6451C17.7381 50.3841 17.6701 49.0581 17.4971 47.7611C17.4551 47.4341 17.4441 47.1011 17.4151 46.7341ZM51.8511 23.0901C51.6361 22.9471 51.4311 22.8651 51.3091 22.7151C51.1661 22.5391 51.0941 22.3041 50.9921 22.0951C51.2611 22.0301 51.5601 21.8551 51.7921 21.9191C52.6741 22.1651 53.0561 23.1311 52.5531 23.9161C51.9181 24.9071 50.9511 25.3951 49.7721 25.3401C48.6311 25.2871 47.9331 24.5731 47.5591 23.5661C47.2581 22.7571 47.3671 21.9271 47.7351 21.1441C47.8651 20.8681 48.0621 20.6191 48.1621 20.3341C48.3961 19.6641 48.0181 19.2011 47.3111 19.2711C46.5671 19.3451 46.1681 19.8561 45.8741 20.4691C44.8881 22.5281 45.7641 25.1111 47.7581 26.0851C50.2391 27.2971 52.6461 25.7421 53.4771 24.1151C53.9591 23.1721 53.7531 21.9071 53.0131 21.2021C52.4971 20.7101 51.8771 20.5341 51.1991 20.7581C50.5731 20.9651 50.1151 21.4121 50.1081 22.0871C50.1041 22.4791 50.2381 22.9881 50.5041 23.2381C50.8531 23.5691 51.3781 23.5611 51.8511 23.0901ZM43.8181 50.5461C44.5731 50.7801 45.3041 51.0731 46.0641 51.2271C47.1651 51.4491 48.2571 51.3281 49.2211 50.7011C49.7401 50.3641 50.1481 49.9141 49.7221 49.0571C49.3291 49.2661 48.9961 49.4321 48.6731 49.6171C47.4041 50.3431 45.3901 50.1301 44.4211 49.0691C44.1311 48.7521 44.0711 48.2201 43.9221 47.7801C43.7981 47.4121 43.7481 46.9151 43.2441 46.9601C42.6831 47.0101 42.8181 47.5051 42.8411 47.8851C42.8461 47.9721 42.8601 48.0591 42.8771 48.1451C43.0781 49.1761 42.9771 50.1411 42.3401 51.0251C42.1971 51.2231 42.1931 51.5211 42.1251 51.7731C42.2081 51.8241 42.2901 51.8761 42.3731 51.9271C42.8581 51.4651 43.3411 51.0031 43.8181 50.5461ZM15.0981 43.2401C14.0521 42.7291 13.4281 42.8631 13.0631 43.6031C12.6061 44.5311 13.0411 45.6291 14.0001 45.9721C14.8351 46.2711 15.3711 46.0341 15.6641 45.1901C15.2751 45.1231 14.8811 45.1011 14.5181 44.9841C13.8581 44.7721 13.7601 44.1201 14.3141 43.6881C14.5331 43.5181 14.7981 43.4091 15.0981 43.2401Z" fill="#FFDD9E"/>
                                <path d="M51.851 23.0901C51.377 23.5611 50.853 23.5691 50.504 23.2401C50.238 22.9901 50.104 22.4811 50.108 22.0891C50.115 21.4131 50.574 20.9661 51.199 20.7601C51.877 20.5361 52.497 20.7121 53.013 21.2041C53.752 21.9091 53.958 23.1741 53.477 24.1171C52.647 25.7441 50.239 27.2981 47.758 26.0871C45.763 25.1131 44.887 22.5301 45.874 20.4711C46.168 19.8571 46.567 19.3461 47.311 19.2731C48.018 19.2031 48.396 19.6661 48.162 20.3361C48.063 20.6211 47.865 20.8701 47.735 21.1461C47.367 21.9291 47.258 22.7591 47.559 23.5681C47.933 24.5751 48.631 25.2881 49.772 25.3421C50.951 25.3971 51.918 24.9091 52.553 23.9181C53.056 23.1331 52.674 22.1671 51.792 21.9211C51.56 21.8561 51.26 22.0321 50.992 22.0971C51.095 22.3061 51.166 22.5411 51.309 22.7171C51.431 22.8661 51.637 22.9481 51.851 23.0901Z" fill="#1A0940"/>
                                <path d="M43.818 50.5461C43.341 51.0031 42.857 51.4651 42.374 51.9271C42.291 51.8761 42.209 51.8241 42.126 51.7731C42.194 51.5211 42.198 51.2231 42.341 51.0251C42.978 50.1411 43.079 49.1761 42.878 48.1451C42.861 48.0591 42.847 47.9721 42.842 47.8851C42.819 47.5041 42.684 47.0091 43.245 46.9601C43.748 46.9151 43.798 47.4121 43.923 47.7801C44.072 48.2191 44.132 48.7511 44.422 49.0691C45.391 50.1301 47.405 50.3431 48.674 49.6171C48.997 49.4321 49.33 49.2661 49.723 49.0571C50.149 49.9141 49.741 50.3631 49.222 50.7011C48.258 51.3281 47.166 51.4491 46.065 51.2271C45.305 51.0731 44.573 50.7801 43.818 50.5461Z" fill="#1A0940"/>
                                <path d="M37.1011 44.1861C36.1801 44.1021 36.2601 45.1301 35.8481 45.6081C35.5851 45.9131 35.2731 46.2801 34.8831 45.9531C34.6831 45.7851 34.5851 45.3121 34.6581 45.0331C34.9251 44.0181 35.5501 43.2371 36.5261 42.8131C37.4711 42.4021 38.4731 42.8501 39.1061 43.5911C39.5641 44.1261 40.3731 45.6161 39.4421 46.0591C38.9121 46.3111 38.5251 46.0391 38.2481 45.5791C37.9841 45.1421 37.9581 44.2641 37.1011 44.1861Z" fill="#1A0940"/>
                                <path d="M51.937 44.9791C51.608 44.8161 51.458 44.2121 51.505 43.7251C51.587 42.8661 52.104 42.0811 52.899 41.7251C53.998 41.2321 55.219 41.7281 55.718 42.8881C55.819 43.1231 55.928 43.4071 55.884 43.6401C55.833 43.9091 55.653 44.3121 55.46 44.3561C55.002 44.4611 54.401 44.1631 54.297 43.7311C54.191 43.2911 53.756 42.8911 53.319 43.0071C52.696 43.1731 52.656 43.6791 52.593 44.1911C52.55 44.5471 52.465 45.2401 51.937 44.9791Z" fill="#1A0940"/>
                                <path d="M15.0982 43.2402C14.7982 43.4092 14.5332 43.5182 14.3152 43.6882C13.7612 44.1202 13.8592 44.7722 14.5192 44.9842C14.8822 45.1012 15.2752 45.1232 15.6652 45.1902C15.3722 46.0342 14.8362 46.2702 14.0012 45.9722C13.0422 45.6292 12.6072 44.5312 13.0642 43.6032C13.4272 42.8632 14.0522 42.7292 15.0982 43.2402Z" fill="#1A0940"/>
                                <path d="M47.8381 46.958C48.0151 46.688 48.4451 46.687 48.5351 46.322C48.6001 46.057 48.4751 45.768 48.2631 45.597C47.9711 45.362 46.5451 45.471 47.5611 44.945C48.0341 44.7 48.5761 44.737 48.9851 45.091C49.4511 45.494 49.4331 46.008 49.1651 46.517C48.9511 46.924 48.2041 47.384 47.7861 47.069C47.7991 47.027 47.8171 46.991 47.8381 46.958Z" fill="#1A0940"/>
                                <path d="M37.4462 52.5262C39.0544 52.5262 40.3582 51.4414 40.3582 50.1032C40.3582 48.765 39.0544 47.6802 37.4462 47.6802C35.8379 47.6802 34.5342 48.765 34.5342 50.1032C34.5342 51.4414 35.8379 52.5262 37.4462 52.5262Z" fill="#F9BD92"/>
                                <path d="M55.1979 50.8057C56.7519 50.4882 57.7944 49.1679 57.5265 47.8569C57.2586 46.5459 55.7817 45.7405 54.2278 46.0581C52.6738 46.3756 51.6312 47.6958 51.8991 49.0069C52.1671 50.3179 53.644 51.1233 55.1979 50.8057Z" fill="#F9BD92"/>
                            </svg>                            
                            )}

                            {randSVG === 4 && (
                            <svg viewBox="0 0 76 76" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M38 74C57.8823 74 74 57.8823 74 38C74 18.1177 57.8823 2 38 2C18.1177 2 2 18.1177 2 38C2 57.8823 18.1177 74 38 74Z" fill="#FFF2DA" stroke="#1A0940" strokeWidth="3"/>
                                <path d="M37.6799 45.173C47.1256 45.173 54.7829 37.5158 54.7829 28.07C54.7829 18.6243 47.1256 10.967 37.6799 10.967C28.2342 10.967 20.5769 18.6243 20.5769 28.07C20.5769 37.5158 28.2342 45.173 37.6799 45.173Z" fill="#FBBB20"/>
                                <path d="M24.594 39.0789C27.731 42.8039 32.428 45.1739 37.68 45.1739C47.126 45.1739 54.784 37.5169 54.784 28.0699C54.784 26.0849 54.442 24.1809 53.821 22.4089C44.175 28.1339 34.441 33.7069 24.594 39.0789Z" fill="#FED072"/>
                                <path d="M37.409 40.8011C44.5898 40.8011 50.411 34.9799 50.411 27.7991C50.411 20.6183 44.5898 14.7971 37.409 14.7971C30.2282 14.7971 24.407 20.6183 24.407 27.7991C24.407 34.9799 30.2282 40.8011 37.409 40.8011Z" fill="#FBBB20"/>
                                <path d="M37.4078 41.1269C30.0588 41.1269 24.0808 35.1479 24.0808 27.7989C24.0808 20.4499 30.0598 14.4709 37.4078 14.4709C44.7578 14.4709 50.7358 20.4499 50.7358 27.7989C50.7358 35.1479 44.7578 41.1269 37.4078 41.1269ZM37.4078 15.4709C30.6108 15.4709 25.0808 21.0009 25.0808 27.7989C25.0808 34.5969 30.6108 40.1269 37.4078 40.1269C44.2058 40.1269 49.7358 34.5969 49.7358 27.7989C49.7358 21.0009 44.2058 15.4709 37.4078 15.4709Z" fill="#FFF2DA"/>
                                <path d="M25.5549 58.2299C35.0006 58.2299 42.6579 50.5727 42.6579 41.1269C42.6579 31.6812 35.0006 24.0239 25.5549 24.0239C16.1092 24.0239 8.4519 31.6812 8.4519 41.1269C8.4519 50.5727 16.1092 58.2299 25.5549 58.2299Z" fill="#FBBB20"/>
                                <path d="M12.469 52.1348C15.606 55.8598 20.303 58.2298 25.555 58.2298C35.001 58.2298 42.659 50.5728 42.659 41.1258C42.659 39.1408 42.317 37.2368 41.696 35.4648C32.05 41.1908 22.316 46.7638 12.469 52.1348Z" fill="#FED072"/>
                                <path d="M25.284 53.858C32.4648 53.858 38.286 48.0368 38.286 40.856C38.286 33.6752 32.4648 27.854 25.284 27.854C18.1032 27.854 12.282 33.6752 12.282 40.856C12.282 48.0368 18.1032 53.858 25.284 53.858Z" fill="#FBBB20"/>
                                <path d="M25.2828 54.1829C17.9338 54.1829 11.9558 48.2039 11.9558 40.8549C11.9558 33.5059 17.9348 27.5269 25.2828 27.5269C32.6328 27.5269 38.6108 33.5059 38.6108 40.8549C38.6108 48.2039 32.6328 54.1829 25.2828 54.1829ZM25.2828 28.5279C18.4858 28.5279 12.9558 34.0579 12.9558 40.8559C12.9558 47.6539 18.4858 53.1839 25.2828 53.1839C32.0808 53.1839 37.6108 47.6539 37.6108 40.8559C37.6108 34.0579 32.0808 28.5279 25.2828 28.5279Z" fill="#FFF2DA"/>
                                <path d="M49.8049 58.2299C59.2506 58.2299 66.9079 50.5727 66.9079 41.1269C66.9079 31.6812 59.2506 24.0239 49.8049 24.0239C40.3592 24.0239 32.7019 31.6812 32.7019 41.1269C32.7019 50.5727 40.3592 58.2299 49.8049 58.2299Z" fill="#FBBB20"/>
                                <path d="M36.719 52.1348C39.856 55.8598 44.553 58.2298 49.805 58.2298C59.251 58.2298 66.909 50.5728 66.909 41.1258C66.909 39.1408 66.567 37.2368 65.946 35.4648C56.3 41.1908 46.566 46.7638 36.719 52.1348Z" fill="#FED072"/>
                                <path d="M49.534 53.858C56.7148 53.858 62.536 48.0368 62.536 40.856C62.536 33.6752 56.7148 27.854 49.534 27.854C42.3532 27.854 36.532 33.6752 36.532 40.856C36.532 48.0368 42.3532 53.858 49.534 53.858Z" fill="#FBBB20"/>
                                <path d="M49.5328 54.1829C42.1838 54.1829 36.2058 48.2039 36.2058 40.8549C36.2058 33.5059 42.1848 27.5269 49.5328 27.5269C56.8828 27.5269 62.8608 33.5059 62.8608 40.8549C62.8608 48.2039 56.8828 54.1829 49.5328 54.1829ZM49.5328 28.5279C42.7358 28.5279 37.2058 34.0579 37.2058 40.8559C37.2058 47.6539 42.7358 53.1839 49.5328 53.1839C56.3308 53.1839 61.8608 47.6539 61.8608 40.8559C61.8608 34.0579 56.3308 28.5279 49.5328 28.5279Z" fill="#FFF2DA"/>
                            </svg>
                            )}
                        </div>
                    </div>
                </motion.div>
            </motion.div>
        </AnimatePresence>
    )
}